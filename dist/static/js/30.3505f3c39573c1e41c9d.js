webpackJsonp([30],{"6NJ4":function(e,t){},Ujni:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("fZjL"),n=a.n(o),i=a("2eFk"),s=a("Ie7z"),l=a("Ke24"),r=a("LRn8"),c=a("P9l9"),d=a("PI0u"),u=a("3E4D"),p=a("Ch4/"),h={name:"reviewed",props:{brandId:{type:String,default:function(){return""}},activeGroupId:{type:String,default:function(){return""}}},data:function(){return{tableH:window.screen.availHeight-464-126,activeTab:"1",activeBrand:this.brandId,activeGroup:this.activeGroupId,topMenuData:[{id:"1",name:"云日报记录"}],activeId:"1",showDialog:!1,conditionObj:{searchInput:"",storeGroup:[],storeType:"",dateRange:[]},storeTypeOptions:[{value:"",label:"所有"},{value:"0",label:"自营"},{value:"1",label:"联营"},{value:"2",label:"代理"},{value:"3",label:"代销"},{value:"4",label:"托管"}],selectRadio:0,tableData:[],multipleSelection:[],currentPage:1,pageSize:20,total:0,appScene:2,defaultStoreList:[],storeTreeSet:{isSelectPerson:!1,dialogVisible:!1,isSingle:!1}}},computed:{},methods:{handleCommand:function(e){this.selectRadio=e},setSelectTab:function(e){this.activeTab=e.tabId},toInput:Object(d.a)(function(e,t){this.currentPage=1,this.getTableList()},500),changeStoreType:function(){this.currentPage=1,this.getTableList()},changeDate:function(e){e||(this.conditionObj.dateRange=[]),this.currentPage=1,this.getTableList()},handleSelectionChange:function(e){this.multipleSelection=e},delDepart:function(e,t){t.splice(e,1),this.currentPage=1,this.defaultStoreList=this.conditionObj.storeGroup,this.getTableList()},multDel:function(){if(!this.multipleSelection.length)return this.$message.error({duration:1e3,message:"请选择删除项"}),!1;this.showDialog=!0},hideDialog:function(e){if(this.showDialog=!1,!n()(e).length)return!1;this.postMultDel(e)},postMultDel:function(e){var t=this,a=[],o=[];t.conditionObj.storeGroup.forEach(function(e){2==e.type&&a.push(e.groupId),3==e.type&&o.push(e.storeId)});var n={search:t.conditionObj.searchInput||"",filterStoreIds:o.join(",")||"",storeIds:t.multipleSelection.map(function(e){return e.storeId}).join(",")||"",storeGroupIds:a.join(",")||"",storeType:t.conditionObj.storeType||"",startDate:t.conditionObj.dateRange[0]||"",endDate:t.conditionObj.dateRange[1]||"",brandId:t.activeBrand,delOptFlag:e.delOptFlag,reason:e.reason,chooseAllFlag:t.selectRadio};Object(c.e)("/haoban-app-daily-web/daily/batch-delete-brand-task",n).then(function(e){var a=e.data;if(1==a.errorCode)return u.a.showmsg("删除成功","success"),void t.getTableList();p.a.errorMsg(a)}).catch(function(e){t.$message.error({duration:1e3,message:e.message})})},exportExcel:function(){var e=this,t=[],a=[];e.conditionObj.storeGroup.forEach(function(e){2==e.type&&t.push(e.groupId),3==e.type&&a.push(e.storeId)});var o={search:e.conditionObj.searchInput||"",filterStoreIds:a.join(",")||"",storeGroupIds:t.join(",")||"",storeType:e.conditionObj.storeType||"",startDate:e.conditionObj.dateRange[0]||"",endDate:e.conditionObj.dateRange[1]||"",brandId:e.activeBrand};Object(c.b)("/haoban-app-daily-web/daily/batch-export-brand-task",o).then(function(e){if(!e.data)return p.a.errorMsg("暂无数据"),!1;var t=new Blob([e.data],{type:"application/vnd.ms-excel"}),a=document.createElement("a");a.download="云日报记录.csv",a.style.display="none",a.href=URL.createObjectURL(t),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)}).catch(function(t){e.$message.error({duration:1e3,message:t.message})})},handleSizeChange:function(e){this.pageSize=e,this.getTableList()},handleCurrentChange:function(e){this.currentPage=e,this.getTableList()},showDialogLayer:function(e,t){this.selectType=e,this.changed=e,this.defaultStoreList=t,this.storeTreeSet={dialogVisible:!0,isSingle:!1,isSelectPerson:!1}},handleSelectedList:function(e){this.conditionObj.storeGroup=e,this.getTableList()},toDetail:function(e,t){this.$router.push("dailyDetail?storeId="+t.storeId+"&appIcon= "+this.$route.query.appIcon)},getTableList:function(e){var t=this,a=[],o=[];t.conditionObj.storeGroup.forEach(function(e){2==e.type&&a.push(e.groupId),3==e.type&&o.push(e.storeId)});var n={search:t.conditionObj.searchInput||"",filterStoreIds:o.join(",")||"",storeGroupIds:a.join(",")||"",storeType:t.conditionObj.storeType||"",startDate:t.conditionObj.dateRange[0]||"",endDate:t.conditionObj.dateRange[1]||"",currentPage:t.currentPage,pageSize:t.pageSize,brandId:t.activeBrand};Object(c.a)("/haoban-app-daily-web/daily/page-brand-task",n).then(function(e){var a=e.data;if(1==a.errorCode)return t.tableData=a.result.result||[],t.total=a.result.totalCount,!1;p.a.errorMsg(a)}).catch(function(e){t.$message.error({duration:1e3,message:e.message})})}},watch:{brandId:function(e,t){e&&(this.activeBrand=e,this.getTableList())},activeGroupId:function(e,t){e&&(this.activeGroup=e)}},mounted:function(){document.documentElement.style.backgroundColor="#f0f2f5",this.activeBrand=this.brandId,this.activeGroup=this.activeGroupId,this.brandId&&this.getTableList()},destroyed:function(){this.activeGroup="",document.documentElement.style.backgroundColor="#fff"},components:{appDetail:i.a,commonDetailTop:l.a,vueSelectStore:s.a,multipleDel:r.a}},b={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"daily-set-wrap "},[a("common-detail-top",{attrs:{topMenuData:e.topMenuData,activeId:e.activeId}}),e._v(" "),a("div",{staticClass:"daily-set-content boder-box"},[a("div",{staticClass:"table-condition flex flex-space-between m-b-23"},[a("div",{staticClass:"table-condition-left"},[a("el-input",{staticClass:"w-264 m-l-10",staticStyle:{width:"264px"},attrs:{placeholder:"请输入门店名称"},nativeOn:{keyup:function(t){return a=t,e.toInput(a,e.conditionObj.searchInput);var a}},model:{value:e.conditionObj.searchInput,callback:function(t){e.$set(e.conditionObj,"searchInput",t)},expression:"conditionObj.searchInput"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),a("div",{staticClass:"flex-column item-cell-select inline-block m-l-10"},[a("div",{staticClass:"depart-item-wrap"},[a("div",{staticClass:"el-select el-select--large depart-item-content",staticStyle:{width:"213px"},on:{click:function(t){e.showDialogLayer("store",e.conditionObj.storeGroup)}}},[e.conditionObj.storeGroup.length?e._e():a("span",{staticClass:"font-14 color-c0c4cc"},[e._v("请选择门店分组")]),e._v(" "),e.conditionObj.storeGroup.length?a("div",{staticClass:"el-select__tags",staticStyle:{"max-width":"181px"}},[a("span",[e._l(e.conditionObj.storeGroup,function(t,o){return[a("span",{key:o,staticClass:"el-tag el-tag--info el-tag--small"},[a("span",{staticClass:"el-select__tags-text"},[e._v(e._s(t.name||t.storeName))]),a("i",{staticClass:"el-tag__close el-icon-close",on:{click:function(t){t.stopPropagation(),e.delDepart(o,e.conditionObj.storeGroup)}}})])]})],2)]):e._e()])])]),e._v(" "),a("el-select",{staticClass:"w-105 m-l-10",attrs:{placeholder:"请选择"},on:{change:e.changeStoreType},model:{value:e.conditionObj.storeType,callback:function(t){e.$set(e.conditionObj,"storeType",t)},expression:"conditionObj.storeType"}},e._l(e.storeTypeOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-date-picker",{staticClass:"m-l-10",attrs:{editable:!1,"value-format":"yyyy-MM-dd",type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeDate},model:{value:e.conditionObj.dateRange,callback:function(t){e.$set(e.conditionObj,"dateRange",t)},expression:"conditionObj.dateRange"}})],1),e._v(" "),a("div",{staticClass:"table-condition-right"},[a("el-button",{attrs:{type:"danger"},on:{click:e.multDel}},[e._v("批量删除")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.exportExcel}},[a("i",{staticClass:"iconfont icon-icon_yunxiazai p-r-6"}),e._v("导出")])],1)]),e._v(" "),a("el-table",{ref:"multipleTable",staticClass:"select-table",style:{width:"100%",minHeight:e.tableH},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"35"}}),e._v(" "),a("el-table-column",{attrs:{width:"25"},scopedSlots:e._u([{key:"header",fn:function(t){return[a("el-dropdown",{staticStyle:{"line-height":"10px",padding:"0","margin-left":"-15px",transform:"translateY(4px)","-webkit-transform":"translateY(4px)"},attrs:{placement:"bottom-start"},on:{command:e.handleCommand}},[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"0"}},[a("span",{style:{color:0==e.selectRadio?"#1890ff":"#606266"}},[e._v("选择当页")])]),e._v(" "),a("el-dropdown-item",{attrs:{command:"1"}},[a("span",{style:{color:1==e.selectRadio?"#1890ff":"#606266"}},[e._v("选择全部")])])],1)],1)]}},{key:"default",fn:function(e){}}])}),e._v(" "),a("el-table-column",{attrs:{label:"门店名称",width:"120","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.storeName))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"任务总数"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.taskCount))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"已完成(含放弃)","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.completedCount))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"完成率(含放弃)","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.completedRate))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"待完成","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.noCompletedCount))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"逾期中","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.overdueCount))]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.toDetail(t.$index,t.row)}}},[e._v("查看详情")])]}}])})],1),e._v(" "),0!=e.tableData.length?a("div",{staticClass:"block common-wrap__page text-right m-t-24"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[20,40,60,80],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1),e._v(" "),a("multiple-del",{attrs:{showDialog:e.showDialog,detailFlag:!1},on:{hideDialog:e.hideDialog}}),e._v(" "),a("vue-select-store",{ref:"storeSelector",attrs:{currentBrand:e.activeGroup,appScene:e.appScene,treeSet:e.storeTreeSet,selectType:"group",defaultList:e.defaultStoreList},on:{handleSelectedList:e.handleSelectedList}})],1)},staticRenderFns:[]};var f=a("VU/8")(h,b,!1,function(e){a("6NJ4")},"data-v-fbb9599c",null);t.default=f.exports}});