webpackJsonp([28],{VAsk:function(t,e){},rRde:function(t,e){},yuVF:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("3Xzz"),o=a("gBtx"),i=a.n(o),l=a("mvHQ"),r=a.n(l),n=a("c4uw"),p=a("Ie7z"),c=a("P9l9"),d=a("3E4D"),u=a("Ch4/"),f={name:"visiable-dialog",props:{showDialog:{type:Boolean,default:!1},appId:{type:String,default:""},appName:{type:String,default:""}},components:{vueSelectEmployee:n.a,vueSelectStore:p.a},data:function(){return{repProjectName:"haoban-manage-web",customDialog:!1,formData:{appId:this.appId,displayType:"0",data:[],departList:[],storeList:[]},appScene:2,treeSet:{isSelectPerson:!1,dialogVisible:!1,isSingle:!1,openNextBool:!0},treeData:{},defaultSelection:[],changed:"",onlyPerson:!1,selectType:"",defaultStoreList:[],storeTreeSet:{isSelectPerson:!1,dialogVisible:!1,isSingle:!1,openNextBool:!0}}},beforeMount:function(){},methods:{handleClose:function(t){t(),this.hideDialog()},customCancel:function(){this.hideDialog()},hideDialog:function(){this.customDialog=!1,this.$emit("hideDialog")},showDialogLayer:function(t,e){if(this.selectType=t,this.changed=t,"store"===t)return this.defaultStoreList=e,void(this.storeTreeSet={dialogVisible:!0,isSingle:!1,isSelectPerson:!0,openNextBool:!0});this.treeSet={dialogVisible:!0,isSingle:!1,isSelectPerson:!0,openNextBool:!0},"people"===t&&(this.onlyPerson=!1,this.treeSet={dialogVisible:!0,isSingle:!1,isSelectPerson:!0}),this.defaultSelection=e,this.treeData.hasOwnProperty("treeData")},handleSelectedList:function(t){console.log(t),"store"===this.selectType?this.formData.storeList=t:this.formData.departList=t},delDepart:function(t,e){e.splice(t,1)},customConfirm:function(){if(0!=this.formData.displayType)if(this.formData.departList.length||this.formData.storeList.length){var t=[];this.formData.departList.length&&this.formData.departList.forEach(function(e){t.push({id:e.id,type:e.hasOwnProperty("employeeClerkId")?1:e.hasOwnProperty("groupId")?2:3})}),this.formData.storeList.length&&this.formData.storeList.forEach(function(e){t.push({id:e.id,type:e.hasOwnProperty("employeeClerkId")?1:e.hasOwnProperty("groupId")?2:3})}),this.setData(t)}else this.$message.error({duration:1e3,message:"请选择可见人员"});else this.setData([])},setData:function(t){var e=this,a={appId:this.appId,displayType:parseInt(e.formData.displayType),data:r()(t)};Object(c.e)("/haoban-manage-web/application-right-save",a).then(function(t){var a=t.data;if(1==a.errorCode)return d.a.showmsg("设置成功","success"),void e.hideDialog();u.a.errorMsg(a)}).catch(function(t){e.$message.error({duration:1e3,message:t.message})})},getSetData:function(){var t=this,e={appId:t.formData.appId};Object(c.e)("/haoban-manage-web/application-right-detail",e).then(function(e){var a=e.data;if(1==a.errorCode)return t.formData.displayType=String(a.result.displayType),t.formData.departList=[],t.formData.storeList=[],a.result.displayRelation&&a.result.displayRelation.length&&a.result.displayRelation.forEach(function(e){2===i()(e.type)&&(e.groupId=e.id),e.label=e.name,e.isStore?t.formData.storeList.push(e):t.formData.departList.push(e)}),t.defaultSelection=t.formData.departList,void(t.defaultStoreList=t.formData.storeList);u.a.errorMsg(a)}).catch(function(e){t.$message.error({duration:1e3,message:e.message})})}},watch:{showDialog:function(t,e){this.customDialog=t},appId:function(t,e){this.formData.appId=t,t&&this.getSetData()}},mounted:function(){this.customDialog=this.showDialog,this.appId&&this.getSetData()}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:t.customDialog,expression:"customDialog"}]},[a("el-dialog",{staticClass:"app-dialog",attrs:{title:t.appName+"可见范围设置",visible:t.customDialog,width:"476px","before-close":t.handleClose},on:{"update:visible":function(e){t.customDialog=e}}},[a("div",{staticClass:"app-dialog-body"},[a("el-form",{ref:"form",attrs:{model:t.formData,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"可见范围"}},[a("div",[a("el-radio",{attrs:{label:"0"},model:{value:t.formData.displayType,callback:function(e){t.$set(t.formData,"displayType",e)},expression:"formData.displayType"}},[t._v("全部员工")])],1),t._v(" "),a("div",[a("el-radio",{attrs:{label:"1"},model:{value:t.formData.displayType,callback:function(e){t.$set(t.formData,"displayType",e)},expression:"formData.displayType"}},[t._v("部分员工")])],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==t.formData.displayType,expression:"formData.displayType == 1"}]},[a("el-form-item",{staticClass:"m-b-0 m-t-10",attrs:{label:"行政架构",prop:"name"}},[a("div",{staticClass:"flex w-380 flex-column item-cell-select"},[a("div",{staticClass:"depart-item-wrap"},[a("div",{staticClass:"el-select el-select--large depart-item-content",on:{click:function(e){t.showDialogLayer("depart",t.formData.departList)}}},[a("div",{staticClass:"el-select__tags",staticStyle:{"max-width":"181px"}},[a("span",[t._l(t.formData.departList,function(e,s){return[a("span",{key:s,staticClass:"el-tag el-tag--info el-tag--small"},[a("span",{staticClass:"el-select__tags-text"},[t._v(t._s(e.name))]),a("i",{staticClass:"el-tag__close el-icon-close",on:{click:function(e){e.stopPropagation(),t.delDepart(s,t.formData.departList)}}})])]})],2)])])])])]),t._v(" "),a("el-form-item",{staticClass:"m-t-22",attrs:{label:"门店架构",prop:"name"}},[a("div",{staticClass:"flex w-380 flex-column item-cell-select"},[a("div",{staticClass:"depart-item-wrap"},[a("div",{staticClass:"el-select el-select--large depart-item-content",staticStyle:{width:"213px"},on:{click:function(e){t.showDialogLayer("store",t.formData.storeList)}}},[a("div",{staticClass:"el-select__tags",staticStyle:{"max-width":"181px"}},[a("span",[t._l(t.formData.storeList,function(e,s){return[a("span",{key:s,staticClass:"el-tag el-tag--info el-tag--small"},[a("span",{staticClass:"el-select__tags-text"},[t._v(t._s(e.name||e.storeName))]),a("i",{staticClass:"el-tag__close el-icon-close",on:{click:function(e){e.stopPropagation(),t.delDepart(s,t.formData.storeList)}}})])]})],2)])])])])])],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.customCancel}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.customConfirm}},[t._v("确 定")])],1)]),t._v(" "),a("vue-select-employee",{attrs:{appScene:t.appScene,defaultSelection:t.defaultSelection,onlyPerson:t.onlyPerson,treeSet:t.treeSet,changed:t.changed},on:{handleSelectedList:t.handleSelectedList}}),t._v(" "),a("vue-select-store",{ref:"storeSelector",attrs:{appScene:t.appScene,treeSet:t.storeTreeSet,selectType:"all",defaultList:t.defaultStoreList},on:{handleSelectedList:t.handleSelectedList}})],1)},staticRenderFns:[]};var h=a("VU/8")(f,m,!1,function(t){a("VAsk")},"data-v-65e3c811",null).exports,g={name:"apps",data:function(){return{tableH:window.screen.availHeight-464-126+"px",navpath:[{name:"首页",path:"/index"},{name:"企业应用",path:""}],appList:[],roleCode:"",appName:"",appId:"",showDialog:!1}},computed:{},methods:{showPeople:function(t){if("master_admin"!=this.roleCode&&"admin"!=this.roleCode)return this.$message.error({duration:1e3,message:"暂无操作权限"}),!1;this.appName=t.appName,this.appId=t.appId,this.showDialog=!0},hideDialog:function(){this.appName="",this.showDialog=!1},changeSwitch:function(t){var e=this;if("master_admin"!=e.roleCode)return e.$message.error({duration:1e3,message:"暂无操作权限"}),!1;var a=1==t.status?"关闭":"开启";e.$confirm("确认"+a+"【"+t.appName+"】应用吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.postSwitch(t)}).catch(function(){})},postSwitch:function(t){var e=this,a={appId:t.appId,status:2==t.status?1:2};Object(c.a)("/haoban-manage-web/application-on-off",a).then(function(e){var a=e.data;if(1==a.errorCode)return d.a.showmsg("操作成功","success"),void(t.status=2==t.status?1:2);u.a.errorMsg(a)}).catch(function(t){e.$message.error({duration:1e3,message:t.message})})},toAppDetail:function(t){if(!t.appUrl)return!1;0==t.appType?this.$router.push(t.appUrl+"?appId="+t.appId+"&appIcon="+t.appIcon):window.open(t.appUrl)},getAppList:function(t){var e=this;Object(c.a)("/haoban-manage-web/application-rigth-list",{}).then(function(t){var a=t.data;1!=a.errorCode?u.a.errorMsg(a):a.result&&a.result.appList&&(e.appList=a.result.appList,e.roleCode=a.result.roleCode)}).catch(function(t){e.$message.error({duration:1e3,message:t.message})})}},mounted:function(){this.getAppList()},components:{navCrumb:s.a,visiableDialog:h}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"apps-wrap common-set-wrap"},[a("nav-crumb",{attrs:{navpath:t.navpath}}),t._v(" "),a("div",{staticClass:"right-content"},[a("div",{staticClass:"right-box"},[a("div",{staticClass:"apps-content"},[a("div",{staticClass:"apps-content-title"},[t._v("基础应用")]),t._v(" "),a("div",{staticClass:"apps-content-body m-t-24"},[a("ul",{staticClass:"flex flex-row flex-wrap"},t._l(t.appList,function(e,s){return a("li",{key:e.appId+s,staticClass:"flex flex-align-center border-box flex",on:{click:function(a){if(a.target!==a.currentTarget)return null;t.toAppDetail(e)}}},[a("span",{staticClass:"square-item flex flex-align-center flex-pack-center",style:{background:e.appBackgroudColor},on:{click:function(a){a.stopPropagation(),t.toAppDetail(e)}}},[a("img",{class:[1==e.status?"":"filter-grayscale"],attrs:{src:e.appIcon,alt:""}})]),t._v(" "),a("span",{staticClass:"color-303133 font-16 p-l-8",on:{click:function(a){if(a.target!==a.currentTarget)return null;t.toAppDetail(e)}}},[t._v(t._s(e.appName))]),t._v(" "),a("div",{staticClass:"cell-arrow-down"},[a("el-dropdown",{staticClass:"app-cell-dropdown",attrs:{trigger:"hover"}},[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-more el-icon--right color-909399",staticStyle:{cursor:"pointer"}})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{staticClass:"p-0"},[a("span",{on:{click:function(a){a.stopPropagation(),t.showPeople(e)}}},[t._v("可见人群")])]),t._v(" "),a("el-dropdown-item",{staticClass:"p-0"},[a("span",{on:{click:function(a){a.stopPropagation(),t.changeSwitch(e)}}},[t._v(t._s(1==e.status?"停用":"启用"))])])],1)],1)],1)])}))])])])]),t._v(" "),a("vue-gic-footer"),t._v(" "),a("visiableDialog",{attrs:{appId:t.appId,appName:t.appName,showDialog:t.showDialog},on:{hideDialog:t.hideDialog}})],1)},staticRenderFns:[]};var D=a("VU/8")(g,v,!1,function(t){a("rRde")},"data-v-0430e9eb",null);e.default=D.exports}});