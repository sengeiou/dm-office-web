webpackJsonp([34],{JUZv:function(e,t){},ys9I:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("fZjL"),r=a.n(n),s=a("3Xzz"),o=a("c4uw"),i=a("PI0u"),l=a("Ch4/"),c=a("3E4D"),u=a("P9l9"),m={name:"replaceAdmin",data:function(){return{navpath:[{name:"首页",path:"/index"},{name:"设置",path:"/companyAddress"},{name:"更换超级管理员",path:""}],subNavText:"更换超级管理员,需要先验证当前超级管理员身份",active:0,ruleForm:{name:"11",phone:1334444444,code:""},rules:{name:[{required:!0,message:"请输入当前绑定账号",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},disableBtn:!1,countNum:60,newFormLoad:!1,newRuleForm:{name:"",id:"",label:"",type:""},newRules:{name:[{required:!0,message:"请输入手机号/姓名",trigger:["blur","change"]}]},treeSet:{isSelectPerson:!0,dialogVisible:!1,isSingle:!0},treeData:{},defaultSelection:[],onlyPerson:!0,changed:""}},computed:{},methods:{showSelect:function(){this.treeSet={dialogVisible:!0,isSingle:!0,isSelectPerson:!0}},handleSelectedList:function(e){e&&r()(e).length&&(this.defaultSelection=[e],this.newRuleForm.name=e.name,this.newRuleForm.id=e.id)},countDown:function(){var e=this,t=setInterval(function(){if(0===e.countNum)return clearInterval(t),e.countNum=60,e.disableBtn=!1,!1;e.countNum--},1e3)},sendCode:Object(i.a)(function(e){this.disableBtn=!0,this.postSendCode(e)},500),postSendCode:function(e){var t=this;Object(u.e)("/haoban-manage-web/enterprise-setting/send-admin-valid-code",{}).then(function(a){var n=a.data;if(1!=n.errorCode)l.a.errorMsg(n);else{t.countDown();var r=String(e).substr(0,3)+"****"+e.substr(7,11);t.$message({message:"验证码已发送到您的手机：+86 "+r,type:"success"})}}).catch(function(e){t.$message.error({duration:1e3,message:e.message})})},submitForm:Object(i.a)(function(e){var t=this;t.$refs[e].validate(function(e){if(!e)return!1;t.checkSendCode()})},500),checkSendCode:function(){var e=this,t={code:e.ruleForm.code};Object(u.e)("/haoban-manage-web/enterprise-setting/check-admin-valid-code",t).then(function(t){var a=t.data;1!=a.errorCode?l.a.errorMsg(a):e.active++>2&&e.active}).catch(function(t){e.$message.error({duration:1e3,message:t.message})})},newSubmitForm:Object(i.a)(function(e){var t=this;t.newRuleForm.name=t.newRuleForm.name.replace(/(^\s+)|(\s+$)/g,""),t.$refs[e].validate(function(e){if(!e)return!1;t.postReplace()})},500),postReplace:function(){var e=this,t={adminClerkId:e.newRuleForm.id};Object(u.e)("/haoban-manage-web/enterprise-setting/change-admin",t).then(function(t){var a=t.data;if(1==a.errorCode)return e.active++,c.a.showmsg("保存成功,请重新登录!","success"),void e.loginOut();l.a.errorMsg(a)}).catch(function(t){e.$message.error({duration:1e3,message:t.message})})},submitFormBack:function(){this.$refs.newRuleForm.resetFields(),this.active&&this.active--},loginOut:function(){var e=this;Object(u.e)("/haoban-manage-web/logout",{}).then(function(t){var a=t.data;1!=a.errorCode?e.$message.error({duration:1e3,message:a.message}):window.location.href=window.location.origin+"/haoban-web/#/login"}).catch(function(t){e.$message.error({duration:1e3,message:t.message})})},getCurrentUser:function(){var e=JSON.parse(localStorage.getItem("userInfo"));this.ruleForm.name=e.name,this.ruleForm.phone=e.phoneNumber}},mounted:function(){this.getCurrentUser()},components:{navCrumb:s.a,vueSelectEmployee:o.a}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"replaceAdmin-wrap common-set-wrap"},[a("nav-crumb",{attrs:{navpath:e.navpath}}),e._v(" "),a("div",{staticClass:"right-content"},[a("div",{staticClass:"right-box",style:{height:e.$store.state.bgHeight}},[a("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"获取验证码"}}),e._v(" "),a("el-step",{attrs:{title:"绑定新的超级管理员"}}),e._v(" "),a("el-step",{attrs:{title:"完成"}})],1),e._v(" "),a("div",{staticClass:"w-514 replaceAdmin-wrap-form m-t-45"},[0==e.active?a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"当前绑定账号",prop:"name"}},[a("el-input",{staticClass:"w-280",attrs:{disabled:"",placeholder:""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{staticClass:"w-280",attrs:{disabled:"",placeholder:""},model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}}),a("el-button",{staticClass:"m-l-20 v-align-b",attrs:{type:"primary",plain:"",disabled:e.disableBtn},on:{click:function(t){e.sendCode(e.ruleForm.phone)}}},[e._v(e._s(!e.disableBtn&&e.countNum?"获取验证码":e.countNum+"s")+" ")])],1),e._v(" "),a("el-form-item",{attrs:{label:"验证码",prop:"code"}},[a("el-input",{staticClass:"w-280",attrs:{placeholder:"请输入验证码"},model:{value:e.ruleForm.code,callback:function(t){e.$set(e.ruleForm,"code",t)},expression:"ruleForm.code"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("下一步")])],1)],1):e._e(),e._v(" "),a("el-form",{directives:[{name:"show",rawName:"v-show",value:1==e.active,expression:"active == 1"}],ref:"newRuleForm",staticClass:"demo-ruleForm",attrs:{model:e.newRuleForm,rules:e.newRules,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"新绑定超级管理员",prop:"name"}},[a("div",{staticClass:"master-select w-280",on:{click:e.showSelect}},[e._v("\n              "+e._s(e.newRuleForm.name?e.newRuleForm.name:"请选择")+"\n            ")])]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.newFormLoad},on:{click:function(t){e.newSubmitForm("newRuleForm")}}},[e._v("提 交")]),e._v(" "),a("el-button",{attrs:{plain:""},on:{click:e.submitFormBack}},[e._v("上一步")])],1)],1),e._v(" "),2==e.active?a("div",{staticClass:"replaceAdmin-wrap-success"},[e._m(0),e._v(" "),a("p",{staticClass:"font-w-500"},[e._v("操作成功")])]):e._e()],1)],1)]),e._v(" "),a("vue-select-employee",{attrs:{defaultSelection:e.defaultSelection,treeSet:e.treeSet,onlyPerson:e.onlyPerson,changed:e.changed},on:{handleSelectedList:e.handleSelectedList}}),e._v(" "),a("vue-gic-footer")],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"icon-outer"},[t("i",{staticClass:"el-icon-success"})])}]};var v=a("VU/8")(m,d,!1,function(e){a("JUZv")},"data-v-c86a4648",null);t.default=v.exports}});