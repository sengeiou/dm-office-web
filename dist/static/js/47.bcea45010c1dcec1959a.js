webpackJsonp([47],{JJdy:function(t,e){},Rwbg:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("3Xzz"),i=a("elmV"),o=a("P9l9"),r={name:"employee-io",components:{navCrumb:s.a,uploadExcelComponent:i.a},data:function(){var t=window.location.origin;return-1!=t.indexOf("localhost")&&(t="http://www.gicdev.com"),{navpath:[{name:"首页",path:"/index"},{name:"企业通讯录",path:"/administrativeFrame"},{name:"行政架构",path:"administrativeFrame"},{name:"批量导入导出",path:""}],host:window.location.origin,windowH:window.screen.availHeight-180+"px",type:"import",fileList:[],url:t+"/haoban-manage-web/emp/upload",uploadSuccessMsg:"",logList:[],loading:!0,pageSize:20,currentPage:1,total:0}},methods:{handleSizeChange:function(t){this.pageSize=t,this.getErrorNote()},handleCurrentChange:function(t){this.currentPage=t,this.getErrorNote()},resetList:function(t){this.fileList=[],"note"==t&&this.getErrorNote()},getErrorNote:function(){var t=this,e={departmentId:t.$route.query.departmentId,importCode:t.$route.query.importCode};Object(o.a)("/haoban-manage-web/error-log-page",e).then(function(e){1==e.data.errorCode?(t.total=e.data.result.totalCount,t.logList=e.data.result.result,t.loading=!1):t.$message.error({message:e.data.message})}).catch(function(e){t.$message.error({message:e.message})})},uploadSuccess:function(t){1==t.errorCode?this.uploadSuccessMsg=t.message.split(","):this.$message.error(t.message),this.fileList=[],this.type="note",this.getErrorNote()},submitUpload:function(t){this.$refs[t].submit()},getChange:function(t,e){var a=e.length-1<0?0:e.length-1,s=t.type?t.type:t.raw.type;if(!("application/vnd.ms-excel"===s||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===s))return this.$message.error("文件格式必须为 xls 或 xlsx 格式!"),this.fileList.splice(a,1),!1;this.fileList=[e[a]]}},beforeMount:function(){"note"==this.type&&this.getErrorNote(),this.$nextTick(function(){document.querySelector(".contact-wrap__body").style.overflow="hidden"})},beforeDestroy:function(){document.querySelector(".contact-wrap__body").style.overflow="auto"}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common-set-wrap",style:{height:t.windowH}},[a("nav-crumb",{attrs:{navpath:t.navpath}}),t._v(" "),a("div",{staticClass:"right-content"},[a("div",{staticClass:"right-box"},[a("div",{staticClass:"io-container border-box "},[t._m(0),t._v(" "),a("el-radio-group",{staticClass:"m-t-20",on:{change:t.resetList},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[a("el-radio-button",{attrs:{label:"import"}},[t._v("导入通讯录")]),t._v(" "),a("el-radio-button",{attrs:{label:"export"}},[t._v("导出")]),t._v(" "),a("el-radio-button",{attrs:{label:"note"}},[t._v("错误记录")])],1),t._v(" "),"import"==t.type?a("div",{staticClass:"handle-area import"},[a("div",{staticClass:"step-div",staticStyle:{"margin-bottom":"90px","line-height":"32px"}},[a("span",{staticClass:"ft-large"},[t._v("①")]),t._v("下载员工通讯录模板，统一收集员工信息\n            "),a("a",{staticClass:"d-u-btn",attrs:{href:t.host+"/haoban-manage-web/excel/通讯录-行政架构导入模板.xlsx"}},[a("el-button",{attrs:{type:"primary"}},[t._v("下载"),a("i",{staticClass:"iconfont icon-icon_yunxiazai m-l-5"})])],1)]),t._v(" "),a("div",{staticClass:"step-div"},[a("span",{staticClass:"ft-large"},[t._v("②")]),t._v("上传收集完毕的员工信息表\n            "),a("div",{staticClass:"d-u-btn"},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.url,"on-success":t.uploadSuccess,"on-change":t.getChange,multiple:!1,"file-list":t.fileList,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("文件格式必须为xls或xlsx格式")])],1)],1)]),t._v(" "),a("div",{staticClass:"up-btn-div"},[a("el-button",{attrs:{type:"primary",disabled:0==t.fileList.length},on:{click:function(e){t.submitUpload("upload")}}},[t._v("上传")])],1)]):"export"==t.type?a("div",{staticClass:"handle-area import"},[a("div",{staticClass:"step-div",staticStyle:{"margin-bottom":"90px","line-height":"32px"}},[a("span",{staticClass:"ft-large"},[t._v("①")]),t._v("导出所有员工信息\n            "),a("a",{staticClass:"d-u-btn",attrs:{href:t.host+"/haoban-manage-web/emp/export?departmentId="+t.$route.query.departmentId+"&showChild="+t.$route.query.showChildMember}},[a("el-button",{attrs:{type:"primary"}},[t._v(" 下载"),a("i",{staticClass:"iconfont icon-icon_yunxiazai m-l-5"})])],1),t._v("\n            批量修改员工信息\n          ")])]):a("div",{staticClass:"error-log import"},[a("div",{staticClass:"title-area"},[a("div",{staticClass:"tip"},[t._v(t._s(t.uploadSuccessMsg))]),t._v(" "),a("a",{attrs:{href:t.host+"/haoban-manage-web/error-improt-log-export?importCode="+t.$route.query.importCode+"&departmentId="+t.$route.query.departmentId}},[a("el-button",{attrs:{type:"primary"}},[t._v("导出错误记录")])],1)]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-t-20",staticStyle:{width:"100%"},attrs:{data:t.logList}},[a("el-table-column",{attrs:{type:"index",width:"50",label:"序号"}}),t._v(" "),a("el-table-column",{attrs:{label:"错误提示",prop:"failReason"}}),t._v(" "),a("el-table-column",{attrs:{label:"姓名",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"手机号",prop:"phoneNumber"}}),t._v(" "),a("el-table-column",{attrs:{label:"部门ID",prop:"departmentId"}}),t._v(" "),a("el-table-column",{attrs:{label:"职位",prop:"positionName"}}),t._v(" "),a("el-table-column",{attrs:{label:"是否此部门负责人（是/否）",prop:"isManager"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(1==e.row.isManager?"是":"否")+"\n              ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"入职时间",prop:"hireDate"}})],1),t._v(" "),t.logList.length?a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","page-sizes":[20,40,60,80],"page-size":t.pageSize,"current-page":t.currentPage,layout:"total, sizes, prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()],1)],1)])]),t._v(" "),a("vue-gic-footer")],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"tip-area border-box "},[a("li",{staticClass:"tip"},[t._v("由于你的企业未进行企业认证，通讯录最多只能导入200人以内的员工，如有超出可先进行"),a("a",{staticClass:"a-href",attrs:{href:"#/companyCertify"}},[t._v("企业认证")])]),t._v(" "),a("li",{staticClass:"tip"},[t._v("不能在本excel表中对员工信息类别进行增加、删除、修改")]),t._v(" "),a("li",{staticClass:"tip"},[t._v("标*字段为必填字段，未标*字段为选填字段")]),t._v(" "),a("li",{staticClass:"tip"},[t._v("\n            员工所在部门：请先到后台创建部门，将部门id填入导入表格中，导入中，若找不到对应部门，将直接将员工挂在根目录下面\n          ")]),t._v(" "),a("li",{staticClass:"tip"},[t._v("未认证企业通讯录最多只能导入200人，超出后无法导入，请先进行企业认证")])])}]};var n=a("VU/8")(r,l,!1,function(t){a("JJdy")},null,null);e.default=n.exports}});