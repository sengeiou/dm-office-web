webpackJsonp([26],{HkK0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),r=a.n(s),n=a("exGp"),o=a.n(n),l=a("P9l9"),c={name:"clerkTbale",components:{vueSelectStore:a("Ie7z").a},props:{store:{type:Object,required:!0},gicFlag:{type:Boolean,default:!0}},data:function(){return{treeSet:{isSelectPerson:!0,dialogVisible:!1,isSingle:!0,openNextBool:!0},selectType:"store",transArr:[],selectedList:[],storeListData:{}}},methods:{goBack:function(){window.location.reload()},transClerk:function(e,t){this.transArr="single"==e?[t]:"all"==e?this.storeListData.clerks:this.selectedList,this.treeSet.dialogVisible=!0},delClerk:function(e){this.$emit("delClerk",e)},selectMember:function(e){this.selectedList=e},handleSelectedList:function(e){var t=this;if(!e.length)return!1;var a=[];t.transArr.forEach(function(e){a.push(e.employeeClerkId)});var s={ids:a.join(","),storeId:e[0].id};Object(l.e)("/haoban-manage-web/emp/batchTransfer",s).then(function(e){1==e.data.errorCode?(t.$message.success({message:"操作成功"}),t.getClerkList()):t.$message.error({message:e.data.message})}).catch(function(e){t.$message.error({message:e.message})})},getClerkList:function(){var e=this,t={departmentId:e.store.storeGroupId,storeId:e.store.storeId,showChild:1,showType:2,pageSize:200,pageNum:1,status:1,isCherk:1};Object(l.e)("/haoban-manage-web/emp/findsimplepage",t).then(function(t){1==t.data.errorCode?e.storeListData.clerks=t.data.result.list||[]:e.$message.error({duration:1e3,message:t.data.message})}).catch(function(t){e.$message.error({duration:1e3,message:t.message})})}},watch:{store:function(e,t){this.storeListData=e||{}}},mounted:function(){this.storeListData=this.store||{}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"recycle-bin"},[a("p",{staticClass:"r-b-top-header"},[a("a",{staticClass:"a-href title",on:{click:e.goBack}},[e._v("返回")]),e._v(" "),e.gicFlag?e._e():a("el-button",{attrs:{disabled:0==e.selectedList.length},on:{click:function(t){e.transClerk("group")}}},[e._v("批量转移")]),e._v(" "),e.gicFlag?e._e():a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.transClerk("all")}}},[e._v("全部转移")])],1),e._v(" "),a("el-table",{ref:"clerkTable",staticStyle:{width:"100%"},attrs:{data:e.storeListData.clerks},on:{"selection-change":e.selectMember}},[a("el-table-column",{attrs:{type:"selection",width:"42"}}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:"手机号码",prop:"phoneNumber"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"80",prop:"clerkCount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.gicFlag?e._e():a("a",{staticClass:"a-href",on:{click:function(a){e.transClerk("single",t.row)}}},[a("i",{staticClass:"el-icon-sort"})]),e._v(" "),e.gicFlag?e._e():a("a",{staticClass:"a-href",on:{click:function(a){e.delClerk(t.row)}}},[a("i",{staticClass:"el-icon-delete"})])]}}])})],1),e._v(" "),a("vue-select-store",{ref:"storeSelector",attrs:{treeSet:e.treeSet,selectType:e.selectType},on:{handleSelectedList:e.handleSelectedList}})],1)},staticRenderFns:[]};var u=a("VU/8")(c,i,!1,function(e){a("jRXt")},null,null).exports,d=a("3Xzz"),h=a("PI0u"),g=a("unF8"),p=a("Ch4/"),m={name:"recycle-bin",components:{navCrumb:d.a,clerkTable:u},data:function(){return{searchKey:"",typeArr:["全部类型","自营","联营","代理(加盟)","代销","托管"],pageSize:20,pageNumber:1,recycleList:[],total:0,navpath:[{name:"首页",path:"/index"},{name:"通讯录",path:"/administrativeFrame"},{name:"门店架构",path:"/storeFrame?showRecycle=0"},{name:"门店回收站",path:""}],clerks:[],showClerks:!1,currentStore:{},brandId:"",gicFlag:!0}},methods:{toInput:Object(h.a)(function(e){this.pageNumber=1,this.getRecycleList()},500),getRecycleList:function(){var e=this,t=e.$route.query,a={storeName:e.searchKey||"",storeGroupId:t.dept,showChild:1*t.showChild,showType:2,pageSize:e.pageSize,pageNum:e.pageNumber,status:4,storeType:t.type};Object(l.a)("/haoban-manage-web/store/findSimplePage",a).then(function(t){1==t.data.errorCode?(e.total=t.data.result.total,e.recycleList=t.data.result.list||[]):(e.recycleList=[],e.$message.error({duration:1e3,message:t.data.message}))}).catch(function(t){e.loading=!1,e.$message.error({duration:1e3,message:t.message})})},restore:function(e){var t=this;t.$confirm("确定要恢复到门店列表吗？","提示",{type:"warning"}).then(function(){var a={status:1,storeId:e.storeId};Object(l.a)("/haoban-manage-web/store/changeStatus",a).then(function(e){1==e.data.errorCode?(t.searchKey="",t.pageNumber=1,t.getRecycleList()):t.$message.error({message:e.data.message})}).catch(function(e){t.$message.error({message:e.message})})}).catch(function(e){})},handleSizeChange:function(e){this.pageSize=e,this.getRecycleList()},handleCurrentChange:function(e){this.pageNumber=e,this.getRecycleList()},showClerksFn:function(e){this.currentStore=e,this.clerks=null==e.clerks?[]:e.clerks,this.showClerks=!0},delClerk:function(e){var t=this.currentStore,a=this;a.$confirm("是否要删除该员工？","提示",{type:"warning"}).then(function(){var s={ids:e.employeeClerkId};Object(l.a)("/haoban-manage-web/emp/del",s).then(function(s){1==s.data.errorCode?t.clerks.forEach(function(a){a.employeeClerkId==e.employeeClerkId&&t.clerks.splice(t.clerks.indexOf(a),1)}):a.$message.error({duration:1e3,message:s.data.message})}).catch(function(e){a.$message.error({duration:1e3,message:e.message})})})},getGicData:function(){var e=this;return o()(r.a.mark(function t(){var a,s,n,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s={type:1,businessId:(a=e).brandId},t.next=4,Object(g.a)(s);case 4:n=t.sent,1==(o=n.data).errorCode?a.gicFlag=o.result:p.a.errorMsg(o);case 7:case"end":return t.stop()}},t,e)}))()}},beforeMount:function(){this.getRecycleList(),this.brandId=this.$route.query.brandId,this.getGicData()}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-set-wrap recycle-wrap"},[a("nav-crumb",{attrs:{navpath:e.navpath}}),e._v(" "),a("div",{staticClass:"right-content"},[a("div",{staticClass:"right-box"},[e.showClerks?a("clerk-table",{attrs:{gicFlag:e.gicFlag,store:e.currentStore},on:{delClerk:e.delClerk}}):a("div",{staticClass:"recycle-bin"},[a("div",{staticClass:"r-b-top-header"},[a("div",{staticClass:"title"},[e._v(e._s(e.recycleList.length)+" 家门店")]),e._v(" "),a("el-input",{attrs:{placeholder:"请输入门店名","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return a=t,e.toInput(a);var a}},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}},[e._v(">")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.recycleList}},[a("el-table-column",{attrs:{label:"门店名称",prop:"storeName"}}),e._v(" "),a("el-table-column",{attrs:{label:"代码",prop:"storeCode"}}),e._v(" "),a("el-table-column",{attrs:{label:"类型",prop:"storeType"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e.typeArr[1*t.row.storeType+1])+"\n            ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"地址",prop:"postAddress"}}),e._v(" "),a("el-table-column",{attrs:{label:"待处理店员",prop:"clerkCount"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"a-href",on:{click:function(a){e.showClerksFn(t.row)}}},[e._v("\n                "+e._s(t.row.clerks.length)+"\n              ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",prop:"clerkCount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.gicFlag?e._e():a("a",{staticClass:"a-href",on:{click:function(a){e.restore(t.row)}}},[e._v("恢复到门店列表")])]}}])})],1),e._v(" "),e.total?a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","page-sizes":[20,40,60,80],"page-size":e.pageSize,"current-page":e.pageNumber,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)],1)]),e._v(" "),a("vue-gic-footer")],1)},staticRenderFns:[]};var b=a("VU/8")(m,f,!1,function(e){a("awO3")},null,null);t.default=b.exports},awO3:function(e,t){},jRXt:function(e,t){}});