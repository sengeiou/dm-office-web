webpackJsonp([39],{IKv2:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("mvHQ"),o=r.n(a),n=r("2eFk"),s=r("Ke24"),c=r("PI0u"),l=r("Ch4/"),i=r("3E4D"),u=r("P9l9"),f={name:"reviewed",props:{brandId:{type:String,default:function(){return""}}},data:function(){return{tableH:window.screen.availHeight-464-126,activeTab:"1",activeBrand:this.brandId,topMenuData:[{id:"1",name:"指标管理",path:"/monthList?appIcon="+this.$route.query.appIcon},{id:"2",name:"月指标",path:"/monthList?appIcon="+this.$route.query.appIcon},{id:"3",name:"门店月指标",path:"storeMonthTask?yearMonth="+this.$route.query.yearMonth+"&appIcon="+this.$route.query.appIcon},{id:"4",name:"导购月指标详情",path:""}],activeId:"4",tableData:[],performanceSum:"",clerkObj:{storeId:"",storeName:"",yearMonth:"",settingAble:1,storePerformance:""},equalFlag:!0}},computed:{},methods:{inputPerformance:function(e,t,r){r.clerkPerformance=Number(r.clerkPerformance.replace(/[^\d.]/g,""))?r.clerkPerformance.replace(/[^\d+(.\d+)]/g,""):"",r.clerkPerformance=Number(r.clerkPerformance).toFixed(2);var a=0;this.tableData.forEach(function(e){a+=Number(e.clerkPerformance)}),this.performanceSum=Number(a).toFixed(2),this.diffData()},inputMonthPerformance:function(e){this.clerkObj.storePerformance=Number(this.clerkObj.storePerformance.replace(/[^\d.]/g,""))?this.clerkObj.storePerformance.replace(/[^\d+(.\d+)]/g,""):"",this.clerkObj.storePerformance=Number(this.clerkObj.storePerformance).toFixed(2),this.diffData()},diffData:function(){var e=Number(this.performanceSum)==Number(this.clerkObj.storePerformance);return this.equalFlag=!!e,e},saveSet:Object(c.a)(function(){if(!this.diffData())return!1;if(""==this.clerkObj.storePerformance)return this.$message.error({duration:1e3,message:"请输入门店月指标"}),!1;var e={clerkPerformanceList:this.tableData,storePerformance:this.clerkObj.storePerformance};this.postSave(e)},500),postSave:function(e){var t=this,r={brandId:t.activeBrand,storeId:t.clerkObj.storeId,yearMonth:t.clerkObj.yearMonth,performance:o()(e)};Object(u.e)("/haoban-app-performance-web/performance/save-clerk-month-performance",r).then(function(e){var t=e.data;1!=t.errorCode?l.a.errorMsg(t):i.a.showmsg("保存成功","success")}).catch(function(e){t.$message.error({duration:1e3,message:e.message})})},getData:function(){var e=this,t={brandId:e.activeBrand,storeId:e.clerkObj.storeId,yearMonth:e.clerkObj.yearMonth};Object(u.e)("/haoban-app-performance-web/performance/query-clerk-month-performance",t).then(function(t){var r=t.data;if(1==r.errorCode){r.result.clerkPerformanceList&&r.result.clerkPerformanceList.length&&(r.result.clerkPerformanceList.forEach(function(e){e.clerkPerformance=Number(e.clerkPerformance).toFixed(2)}),e.tableData=r.result.clerkPerformanceList||[]),r.result.storePerformance=Number(r.result.storePerformance).toFixed(2),e.clerkObj=r.result;var a=0;return e.tableData.forEach(function(e){a+=Number(e.clerkPerformance)}),void(e.performanceSum=Number(a).toFixed(2))}l.a.errorMsg(r)}).catch(function(t){e.$message.error({duration:1e3,message:t.message})})}},watch:{brandId:function(e,t){e&&(this.activeBrand=e,this.clerkObj.yearMonth=this.$route.query.yearMonth,this.clerkObj.storeId=this.$route.query.storeId,this.getData())}},mounted:function(){document.documentElement.style.backgroundColor="#f0f2f5",this.$emit("showTab","11"),this.brandId&&(this.clerkObj.yearMonth=this.$route.query.yearMonth,this.clerkObj.storeId=this.$route.query.storeId,this.getData())},destroyed:function(){document.documentElement.style.backgroundColor="#fff"},components:{appDetail:n.a,commonDetailTop:s.a}},m={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-detail-wrap common-right-wrap"},[r("common-detail-top",{attrs:{topMenuData:e.topMenuData,activeId:e.activeId}}),e._v(" "),r("div",{staticClass:"task-set-content boder-box"},[r("div",{staticClass:"saler-set-title flex flex-space-between m-b-15"},[r("div",{staticClass:"saler-set-title_left"},[r("span",[e._v(e._s(e.clerkObj.yearMonth))]),r("span",{staticClass:"p-l-18"},[e._v(e._s(e.clerkObj.storeName)+"门店导购月指标详情")])]),e._v(" "),r("div",{staticClass:"saler-set-title_right"},[r("span",[e._v("门店月指标：")]),r("el-input",{staticClass:"w-105 p-l-8",attrs:{placeholder:"请输入指标值",disabled:0==e.clerkObj.settingAble},on:{blur:function(t){return e.inputMonthPerformance(t)}},model:{value:e.clerkObj.storePerformance,callback:function(t){e.$set(e.clerkObj,"storePerformance",t)},expression:"clerkObj.storePerformance"}})],1)]),e._v(" "),r("div",{staticClass:"saler-set-table"},[r("el-table",{ref:"multipleTable",staticClass:"select-table",style:{width:"100%",minHeight:e.tableH},attrs:{data:e.tableData,"tooltip-effect":"dark"}},[r("el-table-column",{attrs:{label:"导购"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v(e._s(t.row.clerkName))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"月指标"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[r("el-input",{staticClass:"w-105 p-l-8",attrs:{placeholder:"请输入指标值",disabled:0==e.clerkObj.settingAble},on:{blur:function(r){return e.inputPerformance(r,t.$index,t.row)}},model:{value:t.row.clerkPerformance,callback:function(r){e.$set(t.row,"clerkPerformance",r)},expression:"scope.row.clerkPerformance"}})],1)]}}])})],1)],1),e._v(" "),r("div",{staticClass:"task-set-save text-center m-t-30"},[r("span",{staticClass:"saler-set-sum"},[e._v("导购总计："),r("span",{class:["font-20",e.equalFlag?"color-1890ff":"color-f5222d"]},[e._v(e._s(e.performanceSum))])]),e._v(" "),1==e.clerkObj.settingAble?r("el-button",{attrs:{disabled:!e.equalFlag,type:"primary"},on:{click:e.saveSet}},[e._v("确 认")]):e._e(),e._v(" "),e.equalFlag?e._e():r("span",{staticClass:"font-14 color-f5222d p-l-24"},[e._v("请确保导购月指标总计 = 门店月指标")])],1)])],1)},staticRenderFns:[]};var d=r("VU/8")(f,m,!1,function(e){r("kVwA")},"data-v-8bdd44ec",null);t.default=d.exports},kVwA:function(e,t){}});