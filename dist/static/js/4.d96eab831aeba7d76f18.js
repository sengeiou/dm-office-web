webpackJsonp([4],{"4WTo":function(e,t,n){var a=n("NWt+");e.exports=function(e,t){var n=[];return a(e,!1,n.push,n,t),n}},"7Doy":function(e,t,n){var a=n("EqjI"),s=n("7UMu"),o=n("dSzd")("species");e.exports=function(e){var t;return s(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!s(t.prototype)||(t=void 0),a(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},"9Bbf":function(e,t,n){"use strict";var a=n("kM2E");e.exports=function(e){a(a.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},"9C8M":function(e,t,n){"use strict";var a=n("evD5").f,s=n("Yobk"),o=n("xH/j"),i=n("+ZMJ"),r=n("2KxR"),l=n("NWt+"),c=n("vIB/"),u=n("EGZi"),d=n("bRrM"),h=n("+E39"),p=n("06OY").fastKey,f=n("LIJb"),m=h?"_s":"size",v=function(e,t){var n,a=p(t);if("F"!==a)return e._i[a];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var u=e(function(e,a){r(e,u,t,"_i"),e._t=t,e._i=s(null),e._f=void 0,e._l=void 0,e[m]=0,void 0!=a&&l(a,n,e[c],e)});return o(u.prototype,{clear:function(){for(var e=f(this,t),n=e._i,a=e._f;a;a=a.n)a.r=!0,a.p&&(a.p=a.p.n=void 0),delete n[a.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var n=f(this,t),a=v(n,e);if(a){var s=a.n,o=a.p;delete n._i[a.i],a.r=!0,o&&(o.n=s),s&&(s.p=o),n._f==a&&(n._f=s),n._l==a&&(n._l=o),n[m]--}return!!a},forEach:function(e){f(this,t);for(var n,a=i(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(a(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!v(f(this,t),e)}}),h&&a(u.prototype,"size",{get:function(){return f(this,t)[m]}}),u},def:function(e,t,n){var a,s,o=v(e,t);return o?o.v=n:(e._l=o={i:s=p(t,!0),k:t,v:n,p:a=e._l,n:void 0,r:!1},e._f||(e._f=o),a&&(a.n=o),e[m]++,"F"!==s&&(e._i[s]=o)),e},getEntry:v,setStrong:function(e,t,n){c(e,t,function(e,n){this._t=f(e,t),this._k=n,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))},n?"entries":"values",!n,!0),d(t)}}},ALrJ:function(e,t,n){var a=n("+ZMJ"),s=n("MU5D"),o=n("sB3e"),i=n("QRG4"),r=n("oeOm");e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,u=4==e,d=6==e,h=5==e||d,p=t||r;return function(t,r,f){for(var m,v,g=o(t),_=s(g),y=a(r,f,3),b=i(_.length),C=0,I=n?p(t,b):l?p(t,0):void 0;b>C;C++)if((h||C in _)&&(v=y(m=_[C],C,g),e))if(n)I[C]=v;else if(v)switch(e){case 3:return!0;case 5:return m;case 6:return C;case 2:I.push(m)}else if(u)return!1;return d?-1:c||u?u:I}}},ATfr:function(e,t,n){"use strict";var a=n("0xDb"),s={name:"searchMenu",components:{},props:{treeData:{type:Array,required:!0},searchResult:{type:Object,required:!0},storeFrame:{type:Boolean,default:!1}},data:function(){return{searchKey:"",searchResultShow:!1,myProps:{children:"childrens",label:"label",disabled:"disabled"},menuData:[],defaultOpen:[],defaultId:""}},methods:{clearFn:function(){this.searchResultShow=!1,this.$nextTick(function(){document.querySelector(".el-tree-node").classList.add("is-current")})},searchFn:function(){if(""==this.searchKey)return this.searchResultShow=!1,!1;this.searchResultShow=!0,this.$emit("handleSearchKey",this.searchKey)},handleNodeClick:function(e,t){e.id!=this.defaultId&&document.querySelector(".el-tree-node")&&document.querySelector(".el-tree-node").classList.remove("is-current"),this.defaultId=e.groupId,this.$emit("handleTreeSelection",e,t,"node")},selectEmployee:function(e){this.defaultId=e.employeeClerkId,this.$emit("handleEmployeeSelection",e,"employee")},handleStoreClick:function(e){this.$emit("handleStoreSelection",e,"store")}},filter:{},computed:{employeeList:function(){return this.searchResult.searchList?this.searchResult.searchList:[]},departmentList:function(){return this.searchResult.departmentList?this.searchResult.departmentList:[]},brandList:function(){return this.searchResult.brandList?this.searchResult.brandList:[]}},watch:{treeData:function(e,t){var n=this,s=Object(a.c)(e);n.defaultOpen=s.defaultOpen,n.menuData=s.menuArr,n.menuData.length&&n.$nextTick(function(){n.defaultId=n.menuData.length?n.menuData[0].id:"",document.querySelector(".el-tree-node").classList.add("is-current")})}}},o={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"searh-menu-container"},[n("div",{staticClass:"p-0-15"},[n("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"姓名/手机号/部门名称",clearable:""},on:{clear:e.clearFn},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchFn(t):null}},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),e._v(" "),e._t("buttonBox"),e._v(" "),e.searchResultShow?e._e():n("el-tree",{staticClass:"search-menu",attrs:{"node-key":"id","default-expanded-keys":e.defaultOpen,data:e.menuData,"highlight-current":!0,"expand-on-click-node":!1,props:e.myProps},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node;return t.data,n("span",{staticClass:"custom-tree-node"},[n("i",{staticClass:"iconfont",class:1==a.level?"icon-2zuzhijiagou":"icon-tongshi-zuzhijiagou"}),e._v(" "),n("span",[e._v(e._s(a.label))])])}}])})],2),e._v(" "),e.searchResultShow?n("div",{staticClass:"search-result-container m-t-15"},[e.storeFrame?[e._l(e.brandList,function(t,a){return[t.departmentList.length>0||t.storeList.length>0||t.searchList.length>0?n("div",{key:t.topDepartment.brandId+"_"+a},[n("div",[n("p",{staticClass:"brand-title"},[e._v(e._s(t.topDepartment.name))]),e._v(" "),t.departmentList.length>0?n("ul",{staticClass:"search-result-ul"},[n("p",{staticClass:"title store-frame-title"},[e._v("分组列表")]),e._v(" "),e._l(t.departmentList,function(t,a){return n("li",{key:a+"_"+t.groupId,staticClass:"group-item items",on:{click:function(n){e.handleNodeClick(t)}}},[n("i",{staticClass:"iconfont icon-tongshi-zuzhijiagou"}),e._v("\n                "+e._s(t.name)+"\n              ")])})],2):e._e(),e._v(" "),t.storeList.length>0?n("ul",{staticClass:"search-result-ul"},[n("p",{staticClass:"title store-frame-title"},[e._v("门店列表")]),e._v(" "),e._l(t.storeList,function(t,a){return n("li",{key:a+"_"+t.storeGroupId,staticClass:"group-item items",on:{click:function(n){e.handleStoreClick(t)}}},[n("i",{staticClass:"iconfont icon-tongshi-zuzhijiagou"}),e._v("\n                "+e._s(t.storeName)+"\n              ")])})],2):e._e(),e._v(" "),t.searchList.length>0?n("ul",{staticClass:"search-result-ul"},[n("p",{staticClass:"title store-frame-title"},[e._v("人员列表")]),e._v(" "),e._l(t.searchList,function(t,a){return n("li",{key:a+"_"+t.employeeClerkId,staticClass:"person-item items",on:{click:function(n){e.selectEmployee(t)}}},[n("i",{staticClass:"iconfont icon-chengyuan"}),e._v("\n                "+e._s(t.name)+"\n                "),n("span",{staticClass:"from-group"},[e._v(e._s(t.departmentName))])])})],2):e._e()])]):e._e()]}),e._v(" "),e.brandList.length<1?n("p",{staticClass:"no-data-tip"},[e._v("暂无数据")]):e._e()]:[e.departmentList.length>0?n("ul",{staticClass:"search-result-ul"},[n("p",{staticClass:"title"},[e._v("部门列表")]),e._v(" "),e._l(e.departmentList,function(t,a){return n("li",{key:a+"_"+t.groupId,class:["group-item items",e.defaultId==t.groupId?"active-item":""],on:{click:function(n){e.handleNodeClick(t)}}},[n("i",{staticClass:"iconfont icon-tongshi-zuzhijiagou"}),e._v("\n          "+e._s(t.name)+"\n        ")])})],2):e._e(),e._v(" "),e.employeeList.length>0?n("ul",{staticClass:"search-result-ul"},[n("p",{staticClass:"title"},[e._v("人员列表")]),e._v(" "),e._l(e.employeeList,function(t,a){return n("li",{key:a+"_"+t.employeeClerkId,class:["person-item items",e.defaultId==t.employeeClerkId?"active-item":""],on:{click:function(n){e.selectEmployee(t)}}},[n("i",{staticClass:"iconfont icon-chengyuan"}),e._v("\n          "+e._s(t.name)+"\n          "),n("span",{staticClass:"from-group"},[e._v(e._s(t.departmentName))])])})],2):e._e(),e._v(" "),e.departmentList.length<1&&e.employeeList.length<1?n("p",{staticClass:"no-data-tip"},[e._v("暂无数据")]):e._e()]],2):e._e()])},staticRenderFns:[]};var i=n("VU/8")(s,o,!1,function(e){n("MEND")},null,null);t.a=i.exports},BDhv:function(e,t,n){var a=n("kM2E");a(a.P+a.R,"Set",{toJSON:n("m9gC")("Set")})},HpRW:function(e,t,n){"use strict";var a=n("kM2E"),s=n("lOnJ"),o=n("+ZMJ"),i=n("NWt+");e.exports=function(e){a(a.S,e,{from:function(e){var t,n,a,r,l=arguments[1];return s(this),(t=void 0!==l)&&s(l),void 0==e?new this:(n=[],t?(a=0,r=o(l,arguments[2],2),i(e,!1,function(e){n.push(r(e,a++))})):i(e,!1,n.push,n),new this(n))}})}},LIJb:function(e,t,n){var a=n("EqjI");e.exports=function(e,t){if(!a(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},MEND:function(e,t){},TDHu:function(e,t){},ioQ5:function(e,t,n){n("HpRW")("Set")},kLcy:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("lHA8"),s=n.n(a),o=n("3Xzz"),i=n("ATfr"),r=n("WSbm"),l={name:"employee-table",props:{employeeList:{type:Array,default:function(){return[]}},headList:{type:Array,default:function(){return["selection","name","phoneNumber","positionName","activationStatus"]}}},data:function(){return{tableH:window.screen.availHeight-180}},methods:{selectMember:function(e){this.$emit("selectMember",e)},linkToDetail:function(e){window.location.href="#/employee?employeeClerkId="+e.employeeClerkId}}},c={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"employee-table"},[n("el-table",{attrs:{data:e.employeeList},on:{"selection-change":e.selectMember,"row-click":e.linkToDetail}},[e._l(e.headList,function(t){return["selection"==t?n("el-table-column",{key:t,attrs:{type:"selection",width:"42"}}):e._e(),e._v(" "),"name"==t?n("el-table-column",{key:t,attrs:{label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.name))]),e._v(" "),1==t.row.isManager?n("span",{staticClass:"is-manager"},[e._v("部门负责人")]):e._e()]}}])}):e._e(),e._v(" "),"phoneNumber"==t?n("el-table-column",{key:t,attrs:{label:"手机号",prop:"phoneNumber"}}):e._e(),e._v(" "),"positionName"==t?n("el-table-column",{key:t,attrs:{label:"职位",prop:"positionName"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.positionName?t.row.positionName:"--")+"\n        ")]}}])}):e._e(),e._v(" "),"activationStatus"==t?n("el-table-column",{key:t,attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("div",{staticClass:"status-icon",class:1==e.row.activationStatus?"is-active":""},[n("i",{staticClass:"iconfont icon-shouji"})])]}}])}):e._e()]})],2)],1)},staticRenderFns:[]};var u=n("VU/8")(l,c,!1,function(e){n("TDHu")},null,null).exports,d=n("P9l9"),h={name:"administrativeEstrutura",components:{navCrumb:o.a,searchMenu:i.a,employeeInfo:r.a,employeeList:u},data:function(){return{navpath:[{name:"首页",path:"/index"},{name:"企业通讯录",path:"/administrativeFrame"},{name:"行政架构",path:""}],showChildMember:!1,setDisabledDel:!1,menuData:[],pageSize:20,currentPage:1,selectedList:[],total:0,loading:!0,groupInfo:{groupName:"",departmentId:"",hasPression:""},employeeList:[],searchResult:{},showEmployee:!1,selectedEmployee:{}}},created:function(){},beforeMount:function(){this.getGroupData(),this.getEmployee()},methods:{handleSizeChange:function(e){this.pageSize=e,this.getEmployee()},handleCurrentChange:function(e){this.currentPage=e,this.getEmployee()},addSon:function(){location.href="#/addDepartment?type=group&addnew=1&departmentId="+this.groupInfo.departmentId},goToEdit:function(e){var t=0==e?"company":"group";location.href="#/addDepartment?departmentId="+this.groupInfo.departmentId+"&type="+t},handleSearchKey:function(e){var t=this,n={keyWord:e};Object(d.a)("/haoban-manage-web/emp/searchpage",n).then(function(e){t.searchResult=e.data.result}).catch(function(e){})},handleTreeSelection:function(e,t,n){this.groupInfo.departmentId=e.groupId,this.groupInfo.groupName=e.name,this.showEmployee=n,this.groupInfo.hasPression=e.hasPression,this.groupInfo.level=e.level,this.loading=!0,this.getEmployee()},handleEmployeeSelection:function(e,t){this.selectedEmployee=e,this.showEmployee=t},selectMember:function(e){this.selectedList=e},delMembers:function(){var e=this;e.$confirm("是否要删除选中的员工？","提示",{type:"warning"}).then(function(){e.loading=!0;var t=[];if(e.selectedList.forEach(function(e){t.push(e.employeeClerkId)}),!t.length)return e.$message({message:"请选择员工",type:"warning"}),e.loading=!1,!1;var n={ids:t.join(",")};Object(d.a)("/haoban-manage-web/emp/del",n).then(function(t){if(1==t.data.errorCode){var n=e.selectedList,a=e.employeeList,o=new s.a(n),i=new s.a(a);e.employeeList=n.concat(a).filter(function(e){return!o.has(e)||!i.has(e)}),e.$message.success({message:t.data.message})}else e.$message.error({message:t.data.message});e.loading=!1}).catch(function(t){e.loading=!1,e.$message.error({message:t.message})})})},setChildMemberShow:function(){this.getEmployee()},getGroupData:function(e){var t=this;Object(d.a)("/haoban-manage-web/dept/deptListForCompany",{isStoreGroup:0}).then(function(e){t.menuData=e.data.result.departmentList||[],t.menuData.some(function(e){return 0==e.level&&(t.groupInfo.departmentId=e.groupId,t.groupInfo.groupName=e.name,t.groupInfo.hasPression=e.hasPression,t.groupInfo.level=0),0==e.level}),t.getEmployee()}).catch(function(e){console.log(e,"error")})},getEmployee:function(){var e=this,t={departmentId:e.groupInfo.departmentId,showChild:1*e.showChildMember,pageSize:e.pageSize,pageNum:e.currentPage,status:1};Object(d.a)("/haoban-manage-web/emp/findsimplepage",t).then(function(t){var n=[],a=0;1==t.data.errorCode&&(n=t.data.result&&t.data.result.list?t.data.result.list:[],a=t.data.result&&t.data.result.total?t.data.result.total:0),e.employeeList=n,e.total=a,e.loading=!1}).catch(function(t){console.log(t,"error"),e.loading=!1})}},computed:{disabledDel:function(){return!this.selectedList.length&&!this.setDisabledDel&&1!=this.groupInfo.hasPression}}},p={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"common-set-wrap admin-frame"},[n("nav-crumb",{attrs:{navpath:e.navpath}}),e._v(" "),n("div",{staticClass:"right-content"},[n("div",{staticClass:"right-box"},[n("div",{staticClass:"administrative-estrutura-container common-frame-container",style:{minHeight:e.$store.state.bgHeight}},[n("search-menu",{attrs:{treeData:e.menuData,searchResult:e.searchResult},on:{handleSearchKey:e.handleSearchKey,handleTreeSelection:e.handleTreeSelection,handleEmployeeSelection:e.handleEmployeeSelection}}),e._v(" "),"employee"==e.showEmployee?n("employee-info",{attrs:{perId:e.selectedEmployee.employeeClerkId}}):n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"af-right-container common-right-container"},[n("div",{staticClass:"af-right-header common-right-header"},[n("span",{staticClass:"title-span"},[e._v(e._s(e.groupInfo.groupName)+"（"+e._s(e.total)+"人）")]),e._v(" "),n("span",{staticClass:"id-span"},[e._v("部门ID： "+e._s(e.groupInfo.departmentId))]),e._v(" "),n("span",{staticClass:"handle-area"},[n("el-button",{staticClass:"no-bdr-btn",attrs:{disabled:1!=e.groupInfo.hasPression},on:{click:e.addSon}},[e._v("\n                添加子分组 ")]),n("span",{staticClass:"hurdle"}),n("el-button",{staticClass:"no-bdr-btn",attrs:{href:"#/addGroup?groupId="+e.groupInfo.departmentId,disabled:1!=e.groupInfo.hasPression},on:{click:function(t){e.goToEdit(e.groupInfo.level)}}},[e._v("编辑")])],1)]),e._v(" "),n("div",{staticClass:"af-right-button-box common-right-button-box"},[n("a",{attrs:{href:"#/employee?addnew=1&departmentId="+e.groupInfo.departmentId}},[n("el-button",{attrs:{type:"primary"}},[e._v("添加成员")])],1),e._v(" "),n("a",{attrs:{href:"#/employeeIo?importCode=employee&departmentId="+e.groupInfo.departmentId+"&showChildMember="+1*e.showChildMember}},[n("el-button",[e._v("批量导入/导出")])],1),e._v(" "),n("el-button",{attrs:{type:"danger",disabled:e.disabledDel},on:{click:e.delMembers}},[e._v("批量删除")]),e._v(" "),n("span",{staticClass:"J_show-children inline-block el-button"},[n("el-checkbox",{staticClass:"m-r-10",on:{change:e.setChildMemberShow},model:{value:e.showChildMember,callback:function(t){e.showChildMember=t},expression:"showChildMember"}},[e._v("显示子成员")])],1)],1),e._v(" "),n("employee-list",{attrs:{employeeList:e.employeeList},on:{selectMember:e.selectMember}}),e._v(" "),e.employeeList.length?n("div",{staticClass:"pagination"},[n("el-pagination",{attrs:{background:"","page-sizes":[20,40,60,80],"page-size":e.pageSize,"current-page":e.currentPage,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)],1)])]),e._v(" "),n("vue-gic-footer")],1)},staticRenderFns:[]};var f=n("VU/8")(h,p,!1,function(e){n("oIqJ")},null,null);t.default=f.exports},lHA8:function(e,t,n){e.exports={default:n("pPW7"),__esModule:!0}},m9gC:function(e,t,n){var a=n("RY/4"),s=n("4WTo");e.exports=function(e){return function(){if(a(this)!=e)throw TypeError(e+"#toJSON isn't generic");return s(this)}}},oIqJ:function(e,t){},oNmr:function(e,t,n){n("9Bbf")("Set")},oeOm:function(e,t,n){var a=n("7Doy");e.exports=function(e,t){return new(a(e))(t)}},pPW7:function(e,t,n){n("M6a0"),n("zQR9"),n("+tPU"),n("ttyz"),n("BDhv"),n("oNmr"),n("ioQ5"),e.exports=n("FeBl").Set},qo66:function(e,t,n){"use strict";var a=n("7KvD"),s=n("kM2E"),o=n("06OY"),i=n("S82l"),r=n("hJx8"),l=n("xH/j"),c=n("NWt+"),u=n("2KxR"),d=n("EqjI"),h=n("e6n0"),p=n("evD5").f,f=n("ALrJ")(0),m=n("+E39");e.exports=function(e,t,n,v,g,_){var y=a[e],b=y,C=g?"set":"add",I=b&&b.prototype,k={};return m&&"function"==typeof b&&(_||I.forEach&&!i(function(){(new b).entries().next()}))?(b=t(function(t,n){u(t,b,e,"_c"),t._c=new y,void 0!=n&&c(n,g,t[C],t)}),f("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in I&&(!_||"clear"!=e)&&r(b.prototype,e,function(n,a){if(u(this,b,e),!t&&_&&!d(n))return"get"==e&&void 0;var s=this._c[e](0===n?0:n,a);return t?this:s})}),_||p(b.prototype,"size",{get:function(){return this._c.size}})):(b=v.getConstructor(t,e,g,C),l(b.prototype,n),o.NEED=!0),h(b,e),k[e]=b,s(s.G+s.W+s.F,k),_||v.setStrong(b,e,g),b}},ttyz:function(e,t,n){"use strict";var a=n("9C8M"),s=n("LIJb");e.exports=n("qo66")("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return a.def(s(this,"Set"),e=0===e?0:e,e)}},a)}});