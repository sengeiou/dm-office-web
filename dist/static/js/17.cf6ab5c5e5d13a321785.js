webpackJsonp([17],{"27o1":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("3Xzz"),a={name:"add-clerk-page",components:{clerkInfo:r("oncj").a,navCrumb:n.a},data:function(){return{navpath:[{name:"首页",path:"/index"},{name:"企业通讯录",path:"/administrativeFrame"},{name:"门店架构",path:"/storeFrame"},{name:"新增店员",path:""}],isAddnew:!1,firstLevelId:"",storeType:"",gicFlag:!(!this.$route.query.gicFlag||"false"==this.$route.query.gicFlag)}},beforeMount:function(){this.firstLevelId=this.$route.query.firstLevelId,this.storeType=this.$route.query.type,this.$route.query.clerkId?(this.isAddnew=!1,this.navpath[3].name="编辑店员"):this.isAddnew=!0}},o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"common-set-wrap add-clerk-wrap"},[t("nav-crumb",{attrs:{navpath:this.navpath}}),this._v(" "),t("div",{staticClass:"right-content"},[t("div",{staticClass:"right-box"},[t("div",{staticClass:"add-clerk-page"},[t("clerk-info",{attrs:{storeType:this.storeType,firstLevelId:this.firstLevelId,isAddnew:this.isAddnew,gicFlag:this.gicFlag}})],1)])]),this._v(" "),t("vue-gic-footer")],1)},staticRenderFns:[]};var s=r("VU/8")(a,o,!1,function(e){r("Tb0k")},null,null);t.default=s.exports},Tb0k:function(e,t){},hd98:function(e,t){},oncj:function(e,t,r){"use strict";var n=r("Ie7z"),a=r("P9l9"),o={name:"clerk-info-form",props:{isAddnew:{type:Boolean,default:!1},perId:{type:[String,Number],default:""},firstLevelId:{type:[String,Number],default:""},storeType:{type:[String,Number],default:""},gicFlag:{type:Boolean,default:!1}},components:{vueSelectStore:n.a},data:function(){return{rules:{name:[{required:!0,message:"请输入店员姓名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],phoneNumber:[{required:!0,validator:function(e,t,r){if(t)return/^1[34578]\d{9}$/.test(t)?r():r(new Error("手机号格式不正确"));return r(new Error("请输入手机号"))},trigger:"blur"}],storeName:[{required:!0,message:"请选择门店",trigger:"change"}],code:[{required:!0,message:"请输入code",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],positionName:[{required:!0,message:"请输入店员职位",trigger:"blur"}]},clerkInfo:{storeName:"",storeId:"",managerMode:!1,positionName:"职员"},treeSet:{isSelectPerson:!1,dialogVisible:!1,isSingle:!0,groupId:"",storeType:"",openNextBool:!0},defaultList:[]}},methods:{toInputCode:function(e){var t=this.clerkInfo.code;""!==t&&(this.clerkInfo.code=t.replace(/[^A-Za-z0-9]+/g,""))},saveFn:function(e){var t=!0;this.$refs.clerk_info.validate(function(e){e||(t=!1)}),t&&this.addEmployee(this.clerkInfo,e)},callSelector:function(){this.treeSet.dialogVisible=!0},handleSelectedList:function(e){this.clerkInfo.storeName=e&&e.length?e[0].label:"",this.clerkInfo.storeId=e&&e.length?e[0].id:""},addEmployee:function(e,t){var r=this,n={name:e.name,isClerk:1,phoneNumber:e.phoneNumber,positionName:e.positionName,storeId:e.storeId,managerMode:1*e.managerMode,code:e.code,employeeClerkId:e.employeeClerkId||""},o=r.isAddnew?"/haoban-manage-web/emp/add":"/haoban-manage-web/emp/update";Object(a.a)(o,n).then(function(e){1==e.data.errorCode?(r.$message.success({message:"操作成功"}),1==t?r.clerkInfo={name:"",isClerk:1,phoneNumber:"",positionName:"职员",storeId:"",managerMode:!1,code:""}:r.$router.push("/storeFrame")):r.$message.error({message:e.data.message})}).catch(function(e){r.$message.error({message:e.message})})},cancel:function(){var e=this;this.$confirm(" 是否确认取消，取消后当前页面信息将丢失 ？","提示",{type:"warning"}).then(function(){e.$router.go(-1)}).catch(function(e){})},getClerkInfo:function(){var e=this,t={id:e.$route.query.clerkId?e.$route.query.clerkId:e.perId};Object(a.a)("/haoban-manage-web/emp/findOne",t).then(function(t){1==t.data.errorCode?(e.clerkInfo=t.data.result,e.defaultList=[{id:t.data.result.storeId,label:t.data.result.storeName}]):e.$message.error({message:t.data.message})}).catch(function(t){e.$message.error({message:t})})}},beforeMount:function(){this.treeSet.storeType=this.storeType,this.treeSet.groupId=this.firstLevelId,this.isAddnew||this.getClerkInfo()},watch:{perId:function(e,t){this.getClerkInfo(e)}}},s={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-container bdr-box"},[r("el-form",{ref:"clerk_info",staticClass:"add-clerk-form",attrs:{model:e.clerkInfo,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"姓名",prop:"name"}},[r("el-input",{model:{value:e.clerkInfo.name,callback:function(t){e.$set(e.clerkInfo,"name",t)},expression:"clerkInfo.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"手机号",prop:"phoneNumber"}},[r("el-input",{attrs:{disabled:!e.isAddnew},model:{value:e.clerkInfo.phoneNumber,callback:function(t){e.$set(e.clerkInfo,"phoneNumber",t)},expression:"clerkInfo.phoneNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"门店",prop:"storeName"}},[r("el-input",{attrs:{disabled:!e.isAddnew},on:{focus:e.callSelector},model:{value:e.clerkInfo.storeName,callback:function(t){e.$set(e.clerkInfo,"storeName",t)},expression:"clerkInfo.storeName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"code",prop:"code"}},[r("el-input",{attrs:{disabled:e.gicFlag&&!e.isAddnew},on:{blur:function(t){return e.toInputCode(t)}},model:{value:e.clerkInfo.code,callback:function(t){e.$set(e.clerkInfo,"code",t)},expression:"clerkInfo.code"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"职位",prop:"positionName"}},[r("el-input",{model:{value:e.clerkInfo.positionName,callback:function(t){e.$set(e.clerkInfo,"positionName",t)},expression:"clerkInfo.positionName"}})],1)],1),e._v(" "),r("div",{staticClass:"btn-box"},[r("el-button",{attrs:{type:"primary"},on:{click:e.saveFn}},[e._v("保 存")]),e._v(" "),!e.gicFlag&&e.isAddnew?r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveFn(1)}}},[e._v("保存并继续添加")]):e._e(),e._v(" "),e.gicFlag?e._e():r("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1),e._v(" "),r("vue-select-store",{ref:"storeSelector",attrs:{selectType:"store",defaultList:e.defaultList,treeSet:e.treeSet},on:{handleSelectedList:e.handleSelectedList}})],1)},staticRenderFns:[]};var i=r("VU/8")(o,s,!1,function(e){r("hd98")},null,null);t.a=i.exports}});