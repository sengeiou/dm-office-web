webpackJsonp([13],{8353:function(e,t){},NNAT:function(e,t,a){"use strict";var o=a("fZjL"),i=a.n(o),s=a("mvHQ"),r=a.n(s),n=a("P9l9"),l=a("Xxa5"),c=a.n(l),d=a("exGp"),p=a.n(d),u=a("0xDb"),h=a("unF8"),m=a("Ch4/"),f={name:"list-item",props:{item:{type:String,required:!0}},filters:{formatDate:u.b},data:function(){return{typeList:["全部","全职","兼职","外包","实习","无类型"],statusList:["全部","正式","试用","离职"],reasons:["","家庭原因","个人原因","发展原因","合同到期不续签","协议解除","无法胜任工作","经济性裁员","严重违法违纪","其他"],propList:{headPic:{label:"",slot:!0,width:50},clerkName:{label:"姓名",width:90},clerkPhone:{label:"手机号"},groupName:{label:"部门"},clerkCode:{label:"code"},positionName:{label:"职位"},clerkType:{label:"员工类型",slot:!0},clerkStatus:{label:"员工状态",slot:!0},hireDate:{label:"入职日期",needSort:"custom",slot:!0},correctionDate:{label:"转正日期",needSort:"custom",slot:!0},fireDate:{label:"离职日期",needSort:"custom",slot:!0},fireReason:{label:"离职原因",slot:!0},handleEmployee:{label:"操作",slot:!0},handleUnEmployee:{label:"操作",slot:!0}}}},methods:{callHandle:function(e){"编辑员工资料"!=e.typeTitle?this.getGicData(e):location.href="#/recordInfo?recordId="+e.obj.recordId},getGicData:function(e){var t=this;return p()(c.a.mark(function a(){var o,i,s,r;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=t,i={type:3,businessId:e.obj.recordId},a.next=4,Object(h.a)(i);case 4:if(s=a.sent,1!=(r=s.data).errorCode){a.next=13;break}if(!r.result){a.next=10;break}return o.$message.error({duration:1e3,message:"已经与 GIC 门店同步，暂无操作权限"}),a.abrupt("return",!1);case 10:o.$emit("callHandle",e.obj,e.type,e.typeTitle),a.next=14;break;case 13:m.a.errorMsg(r);case 14:case"end":return a.stop()}},a,t)}))()}},mounted:function(){}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.propList[e.item].slot?a("el-table-column",{attrs:{label:e.propList[e.item].label,width:e.propList[e.item].width,sortable:e.propList[e.item].needSort,prop:e.item},scopedSlots:e._u([{key:"default",fn:function(t){return["clerkType"==e.item?a("div",[e._v("\n      "+e._s(e.typeList[t.row[e.item]||5])+"\n    ")]):e._e(),e._v(" "),"clerkStatus"==e.item?a("div",[e._v("\n      "+e._s(e.statusList[t.row[e.item]]||"无状态")+"\n    ")]):"hireDate"==e.item||"correctionDate"==e.item||"fireDate"==e.item?a("div",[e._v("\n      "+e._s(e._f("formatDate")(t.row[e.item],"YY-MM-DD")||"--")+"\n    ")]):"headPic"==e.item?a("div",[t.row[e.item]?a("img",{staticClass:"header-pic",attrs:{src:t.row[e.item]}}):a("div",{staticClass:"replace-head-img"},[a("i",{staticClass:"iconfont icon-yewuduanmorentouxian"})])]):"fireReason"==e.item?a("div",[e._v("\n      "+e._s(e.reasons[t.row[e.item]]||"--")+"\n    ")]):"handleEmployee"==e.item?a("div",[a("div",{staticClass:"table-handle"},[a("el-dropdown",{staticClass:"more",on:{command:e.callHandle}},[a("span",{staticClass:"el-dropdown-link"},[e._v(" 更多"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[2==t.row.clerkStatus?[a("el-dropdown-item",{attrs:{command:{obj:t.row,type:"turnPositive",typeTitle:"办理转正"}}},[e._v("办理转正")]),e._v(" "),a("el-dropdown-item",{attrs:{command:{obj:t.row,type:"eidtCorrectionTime",typeTitle:"修改转正时间"}}},[e._v("修改转正时间")])]:e._e(),e._v(" "),a("el-dropdown-item",{attrs:{command:{obj:t.row,type:"editEmployee",typeTitle:"编辑员工资料"}}},[e._v("编辑员工资料")]),e._v(" "),a("el-dropdown-item",{attrs:{command:{obj:t.row,type:"resignation",typeTitle:"办理离职"}}},[e._v("办理离职")])],2)],1)],1)]):"handleUnEmployee"==e.item?a("div",[a("div",{staticClass:"table-handle"},[a("a",{staticClass:"a-href",attrs:{href:"#/recordInfo?recordId="+t.row.recordId+"&type=unemployee"}},[e._v("编辑")])])]):e._e()]}}])}):a("el-table-column",{attrs:{"class-name":"clerkName"==e.item?"control-width":"",label:e.propList[e.item].label,width:e.propList[e.item].width,prop:e.item,"show-overflow-tooltip":""}})},staticRenderFns:[]};var g=a("VU/8")(f,y,!1,function(e){a("RBF8")},null,null).exports,v=a("IVno"),S=a("Ie7z"),b=a("c4uw"),k={name:"employeeRecordList",props:{isUnEmployee:{type:Boolean,default:!1}},components:{listItem:g,handleDialog:v.a,vueSelectStore:S.a,vueSelectEmployee:b.a},data:function(){return{tableH:window.screen.availHeight-440-160,pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},employeeList:[],pageNum:1,pageSize:20,sortType:"desc",sortColumn:"hireDate",statusList:[{label:"全部",id:"0"},{label:"正式",id:"1"},{label:"试用",id:"2"},{label:"无状态",id:"-1"}],typeLsit:["全部","全职","兼职","外包","实习","无类型"],clerkType:0,clerkStatus:"0",total:0,handleType:"turnPositive",typeTitle:"",dialogVisible:!1,employeeObj:{},fireDate:[],startDate:"",endDate:"",showSelector:!0,searchParam:"",departMentSet:{},storeSet:{},treeData:{},selectionList:[],disabled:!0,chooseClerkIdList:[],chooseGroupIdList:[],chooseStoreIdList:[],adDefaultSelection:[],changed:0,defaultStoreList:[],treeSetDepart:{isSelectPerson:!0,dialogVisible:!1,isSingle:!1,openNextBool:!0},treeSetStore:{isSelectPerson:!0,dialogVisible:!1,isSingle:!1,openNextBool:!0}}},methods:{searchFn:function(){this.getEmloyeeList()},getGroupData:function(){var e=this;Object(n.a)("/haoban-manage-web/dept/deptListForCompany",{isStoreGroup:0}).then(function(t){var a=[],o=[];1==t.data.errorCode&&(a=t.data.result.departmentList||[],o=t.data.result.searchList||[]),e.treeData={treeData:a,personData:o},e.disabled=!1}).catch(function(e){})},callSelector:function(){this.treeSetDepart.dialogVisible=!0},callStoreSelector:function(){this.treeSetStore.dialogVisible=!0},showExportSet:function(){if(this.isUnEmployee){var e=window.location.origin;-1!=e.indexOf("localhost")&&(e="http://www.gicdev.com");var t=0==this.clerkType?"":this.clerkType;location.href=e+"/haoban-manage-web/record/export-fire-employee-record?clerkType="+t+"&sortType="+this.sortType+"&sortColumn="+this.sortColumn+"&startDate="+this.startDate+"&endDate="+this.endDate+"&searchParam="+this.searchParam+"&chooseClerkIdList="+this.chooseClerkIdList.join(",")+"&chooseGroupIdList="+this.chooseGroupIdList.join(",")+"&chooseStoreIdList="+this.chooseStoreIdList.join(",")}else this.$emit("showExportSetFn")},handleSelectedList:function(e){this.adDefaultSelection=e||[],this.concatList()},handleStoreSelectedList:function(e){this.defaultStoreList=e||[],this.concatList()},concatList:function(){this.selectionList=this.adDefaultSelection.concat(this.defaultStoreList),this.formatSelectionList(this.selectionList)},formatSelectionList:function(e){var t=this,a=t.unique(e);t.selectionList=a,t.chooseClerkIdList=[],t.chooseStoreIdList=[],t.chooseGroupIdList=[],a.length&&a.forEach(function(e){1==e.type?t.chooseClerkIdList.push(e.employeeClerkId):3==e.type?t.chooseStoreIdList.push(e.storeId):2==e.type&&t.chooseGroupIdList.push(e.groupId)}),t.pageNum=1,t.getEmloyeeList()},unique:function(e){var t={};return e.forEach(function(e){t[r()(e)]=e}),e=i()(t).map(function(e){return JSON.parse(e)})},delSld:function(e,t){var a=this,o=a.selectionList.indexOf(e);a.selectionList.splice(o,1),(3==e.type||e.hasOwnProperty("isStoreGroup")&&1==e.isStoreGroup||e.hasOwnProperty("isClerk")&&1==e.isClerk)&&a.defaultStoreList.forEach(function(t,o){t.id==e.id&&a.defaultStoreList.splice(o,1)}),(e.hasOwnProperty("isStoreGroup")&&0==e.isStoreGroup||e.hasOwnProperty("isClerk")&&0==e.isClerk)&&a.adDefaultSelection.forEach(function(t,o){t.id==e.id&&a.adDefaultSelection.splice(o,1)}),a.formatSelectionList(a.selectionList),a.changed+=1},handleSuccess:function(){this.dialogVisible=!1,this.getEmloyeeList()},callHandle:function(e,t,a){this.handleType=t,this.employeeObj=e,this.typeTitle=a,this.dialogVisible=!0},handleSizeChange:function(e){this.pageSize=e,this.getEmloyeeList()},handleCurrentChange:function(e){this.pageNum=e,this.getEmloyeeList()},sortList:function(e){this.sortColumn=e.prop,this.sortType="descending"==e.order?"desc":"asc",this.getEmloyeeList()},reGetList:function(){this.getEmloyeeList()},getEmloyeeList:function(){var e=this,t=e.isUnEmployee,a=t?"/haoban-manage-web/record/find-fire-employee-record-page":"/haoban-manage-web/record/find-on-work-employee-record-page",o={pageNum:e.pageNum,chooseClerkIdList:e.chooseClerkIdList.join(","),chooseGroupIdList:e.chooseGroupIdList.join(","),chooseStoreIdList:e.chooseStoreIdList.join(","),pageSize:e.pageSize,sortType:e.sortType,clerkStatus:0==e.clerkStatus?"":e.clerkStatus,sortColumn:e.sortColumn,clerkType:0==e.clerkType?"":e.clerkType,startDate:e.startDate,endDate:e.endDate,searchParam:e.searchParam};Object(n.a)(a,o).then(function(a){1==a.data.errorCode?(e.employeeList=a.data.result.list,e.total=t?a.data.result.total:a.data.result.pageInfo.total):e.$message.error({message:a.data.message})}).catch(function(t){e.$message({message:t.message})})},selectDate:function(e){e?(this.startDate=e[0],this.endDate=e[1]):(this.startDate="",this.endDate=""),this.getEmloyeeList()}},beforeMount:function(){this.getEmloyeeList(),this.getGroupData()},computed:{propList:function(){return this.isUnEmployee?["headPic","clerkName","clerkPhone","groupName","clerkCode","positionName","clerkType","clerkStatus","hireDate","fireDate","fireReason","handleUnEmployee"]:["headPic","clerkName","clerkPhone","groupName","clerkCode","positionName","clerkType","clerkStatus","hireDate","correctionDate","handleEmployee"]}}},L={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"e-r-l-container"},[a("div",{staticClass:"handle-area"},[a("div",{staticClass:"flex1"},[a("el-button",{staticStyle:{"margin-right":"10px",height:"32px"},attrs:{disabled:e.disabled},on:{click:e.callSelector}},[e._v("行政架构选人")]),e._v(" "),a("el-button",{staticStyle:{"margin-right":"10px",height:"32px"},on:{click:e.callStoreSelector}},[e._v("门店架构选人")]),e._v(" "),e.isUnEmployee?a("div",{staticClass:"block"},[a("span",{staticClass:"demonstration"},[e._v("离职日期")]),e._v(" "),a("el-date-picker",{attrs:{type:"daterange",align:"right","value-format":"yyyy-MM-dd","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions2},on:{change:e.selectDate},model:{value:e.fireDate,callback:function(t){e.fireDate=t},expression:"fireDate"}})],1):[a("el-select",{staticClass:"m-r-10 w-130",attrs:{placeholder:"选择类型"},on:{change:e.reGetList},model:{value:e.clerkType,callback:function(t){e.clerkType=t},expression:"clerkType"}},e._l(e.typeLsit,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})),e._v(" "),a("el-select",{staticClass:"w-130",attrs:{placeholder:"选择状态"},on:{change:e.reGetList},model:{value:e.clerkStatus,callback:function(t){e.clerkStatus=t},expression:"clerkStatus"}},e._l(e.statusList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.id}})}))],e._v(" "),a("el-input",{staticStyle:{width:"218px","margin-left":"10px"},attrs:{placeholder:"请输入姓名或手机号",clearable:""},on:{clear:e.searchFn},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.searchFn(t):null}},model:{value:e.searchParam,callback:function(t){e.searchParam=t},expression:"searchParam"}})],2),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.showExportSet}},[a("i",{staticClass:"iconfont icon-icon_yunxiazai p-r-6"}),e._v("导出")])],1),e._v(" "),e.selectionList.length?a("ul",{staticClass:"selector-selected-list"},[e._l(e.selectionList,function(t,o){return[a("li",{key:o+t.id+t.label,staticClass:"sld"},[e._v(e._s(t.label)+" "),a("i",{staticClass:"el-icon-close",on:{click:function(a){e.delSld(t,t.isStoreGroup)}}})])]}),e._v(" "),a("li",{staticClass:"sld tip"},[e._v("共筛选出"+e._s(e.total)+"人")])],2):e._e(),e._v(" "),a("el-table",{staticClass:"list-table",attrs:{data:e.employeeList,"default-sort":{prop:"hireDate",order:"descending"}},on:{"sort-change":e.sortList}},[e._l(e.propList,function(t){return[a("list-item",{key:t,attrs:{item:t},on:{callHandle:e.callHandle}})]})],2),e._v(" "),e.employeeList.length?a("el-pagination",{staticClass:"pagination",attrs:{background:"","page-sizes":[20,40,60,80],"page-size":e.pageSize,"current-page":e.pageNum,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e(),e._v(" "),a("el-dialog",{attrs:{title:e.typeTitle,visible:e.dialogVisible,width:"480px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("handle-dialog",{attrs:{employee:e.employeeObj,handleType:e.handleType,typeTitle:e.typeTitle},on:{handleSuccess:e.handleSuccess}})],1),e._v(" "),a("vue-select-store",{ref:"storeSelector",attrs:{defaultList:e.defaultStoreList,treeSet:e.treeSetStore},on:{handleSelectedList:e.handleStoreSelectedList}}),e._v(" "),a("vue-select-employee",{ref:"departmentSelector",attrs:{treeSet:e.treeSetDepart,changed:e.changed,treeData:e.treeData,defaultSelection:e.adDefaultSelection},on:{handleSelectedList:e.handleSelectedList}})],1)},staticRenderFns:[]};var C=a("VU/8")(k,L,!1,function(e){a("8353")},null,null);t.a=C.exports},RBF8:function(e,t){},TGrv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("3Xzz"),i=a("NNAT"),s={name:"employeeRecord",components:{navCrumb:o.a,employeeList:i.a},data:function(){return{navpath:[{name:"首页",path:"/index"},{name:"通讯录",path:"/administrativeFrame"},{name:"员工档案",path:"/fileSet"},{name:"离职员工",path:""}],typeObj:{onWorkCout:"在职员工",allWorkCount:"全职",partTimeWorkCount:"兼职",outWorkCount:"外包",practiceWorkCount:"实习",noTypeWorkCount:"无类型",regularCount:"正式",onTrialCount:"试用",noStatusCount:"无状态"},countObj:{}}},beforeMount:function(){}},r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"common-set-wrap unemployee-wrap"},[t("nav-crumb",{attrs:{navpath:this.navpath}}),this._v(" "),t("div",{staticClass:"right-content"},[t("div",{staticClass:"right-box"},[t("div",{staticClass:"e-record-container"},[t("employee-list",{attrs:{isUnEmployee:!0}})],1)])]),this._v(" "),t("vue-gic-footer")],1)},staticRenderFns:[]};var n=a("VU/8")(s,r,!1,function(e){a("XAGK")},null,null);t.default=n.exports},XAGK:function(e,t){}});